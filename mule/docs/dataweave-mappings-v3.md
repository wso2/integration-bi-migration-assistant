###### This markdown file is AUTO-GENERATED by the test suite. Do not modify manually. ######

# Supported Dataweave 1.0 (Mule 3.x) Constructs

- [Concat Array Expression](dataweave-mappings-v3.md#concat-array-expression)
- [Concat Object Expression](dataweave-mappings-v3.md#concat-object-expression)
- [Concat String Expression](dataweave-mappings-v3.md#concat-string-expression)
- [Date Type Expression](dataweave-mappings-v3.md#date-type-expression)
- [Filter Value Identifier Expression](dataweave-mappings-v3.md#filter-value-identifier-expression)
- [Lower Expression](dataweave-mappings-v3.md#lower-expression)
- [Map Combination Expression](dataweave-mappings-v3.md#map-combination-expression)
- [Map Index Identifier Expression](dataweave-mappings-v3.md#map-index-identifier-expression)
- [Map Index Identifier Only Expression](dataweave-mappings-v3.md#map-index-identifier-only-expression)
- [Map Value Identifier Expression](dataweave-mappings-v3.md#map-value-identifier-expression)
- [Map With Parameters Expression](dataweave-mappings-v3.md#map-with-parameters-expression)
- [Replace With Expression](dataweave-mappings-v3.md#replace-with-expression)
- [Single Selector Expression](dataweave-mappings-v3.md#single-selector-expression)
- [Sizeof Expression](dataweave-mappings-v3.md#sizeof-expression)
- [String Return Expression](dataweave-mappings-v3.md#string-return-expression)
- [Type Coercion Date To Number Expression](dataweave-mappings-v3.md#type-coercion-date-to-number-expression)
- [Type Coercion Format Expression](dataweave-mappings-v3.md#type-coercion-format-expression)
- [Type Coercion Number Expression](dataweave-mappings-v3.md#type-coercion-number-expression)
- [Type Coercion String Expression](dataweave-mappings-v3.md#type-coercion-string-expression)
- [Type Coercion To Date Expression](dataweave-mappings-v3.md#type-coercion-to-date-expression)
- [Upper Expression](dataweave-mappings-v3.md#upper-expression)
- [When Otherwise Expression](dataweave-mappings-v3.md#when-otherwise-expression)
- [When Otherwise Nested Expression](dataweave-mappings-v3.md#when-otherwise-nested-expression)
# DataWeave to Ballerina Transformations (Mule 3.x)

This section provides examples of DataWeave scripts and their corresponding Ballerina implementations.

## Concat Array Expression

**DataWeave Script (transform_message_with_concat_array.dwl):**
```dataweave
%dw 1.0
%output application/json
---
{
  a: [0, 1, 2] ++ [3, 4, 5]
}

```

**Ballerina Output (transform_message_with_concat_array.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

function _dwMethod0_(Context ctx) returns json|error {
    any[] _var_0 = [0, 1, 2];
    var _var_1 = [3, 4, 5];
    return {"a": check _var_0.push(..._var_1).ensureType(json)};
}

public function sampleFlow(Context ctx) {
    json _dwOutput_ = check _dwMethod0_();
    ctx.payload = _dwOutput_;
}

```

## Concat Object Expression

**DataWeave Script (transform_message_with_concat_object.dwl):**
```dataweave
%dw 1.0
%output application/json
---
concat: {aa: "a"} ++ {cc: "c"}

```

**Ballerina Output (transform_message_with_concat_object.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = check _dwMethod0_();
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json|error {
    var _var_0 = {"aa": "a"};
    return {"concat": check {_var_0, "cc": "c"}.ensureType(json)};
}

```

## Concat String Expression

**DataWeave Script (transform_message_with_concat_string.dwl):**
```dataweave
%dw 1.0
%output application/json
---
{
  name: "Ballerina " ++ "Conversion"
}

```

**Ballerina Output (transform_message_with_concat_string.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

function _dwMethod0_(Context ctx) returns json {
    return {"name": "Ballerina " + "Conversion"};
}

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_();
    ctx.payload = _dwOutput_;
}

```

## Date Type Expression

**DataWeave Script (transform_message_with_date_type.dwl):**
```dataweave
%dw 1.0
%output application/json
---
{
    date: |2021-01-01|,
    time: |23:59:56|,
    timeZone: |-08:00|,
    dateTime: |2003-10-01T23:57:59-03:00|,
    localDateTime: |2003-10-01T23:57:59|
}

```

**Ballerina Output (transform_message_with_date_type.bal):**
```ballerina
import ballerina/time;

public type Context record {|
    anydata payload = ();
|};

function _dwMethod0_(Context ctx) returns json|error {
    return {"date": check time:civilFromString("2021-01-01").ensureType(json), "time": check time:civilFromString("23:59:56").ensureType(json), "timeZone": check time:civilFromString("-08:00").ensureType(json), "dateTime": check time:civilFromString("2003-10-01T23:57:59-03:00").ensureType(json), "localDateTime": check time:civilFromString("2003-10-01T23:57:59").ensureType(json)};
}

public function sampleFlow(Context ctx) {
    json _dwOutput_ = check _dwMethod0_();
    ctx.payload = _dwOutput_;
}

```

## Filter Value Identifier Expression

**DataWeave Script (transform_message_with_filter_value_identifier.dwl):**
```dataweave
%dw 1.0
%output application/json
%input payload application/json
---
[1, 2, 3, 4] filter $ > 2

```

**Ballerina Output (transform_message_with_filter_value_identifier.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json {
    var _var_0 = [1, 2, 3, 4];
    return _var_0.filter(element => element > 2);
}

```

## Lower Expression

**DataWeave Script (transform_message_with_lower.dwl):**
```dataweave
%dw 1.0
%output application/json
---
lower "APPLE"

```

**Ballerina Output (transform_message_with_lower.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_();
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json {
    return "APPLE".toLowerAscii();
}

```

## Map Combination Expression

**DataWeave Script (transform_message_with_map_combination.dwl):**
```dataweave
%dw 1.0
%output application/json
---
users: ["john", "peter", "matt"] map  upper $

```

**Ballerina Output (transform_message_with_map_combination.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

function _dwMethod0_(Context ctx) returns json {
    var _var_0 = ["john", "peter", "matt"];
    return {"users": _var_0.'map(element => element.toUpperAscii())};
}

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_();
    ctx.payload = _dwOutput_;
}

```

## Map Index Identifier Expression

**DataWeave Script (transform_message_with_map_index_identifier.dwl):**
```dataweave
%dw 1.0
%output application/json
%input payload application/json
---
[1, 2, 3, 4] map $ + $$

```

**Ballerina Output (transform_message_with_map_index_identifier.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json {
    var _var_0 = [1, 2, 3, 4];
    return _var_0.'map(element => element + _var_0.indexOf(element));
}

```

## Map Index Identifier Only Expression

**DataWeave Script (transform_message_with_map_index_identifier_only.dwl):**
```dataweave
%dw 1.0
%output application/json
%input payload application/json
---
[1, 2, 3, 4] map $$ + 1

```

**Ballerina Output (transform_message_with_map_index_identifier_only.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json {
    var _var_0 = [1, 2, 3, 4];
    return _var_0.'map(element => _var_0.indexOf(element) + 1);
}

```

## Map Value Identifier Expression

**DataWeave Script (transform_message_with_map_value_identifier.dwl):**
```dataweave
%dw 1.0
%output application/json
%input payload application/json
---
[1, 2, 3, 4] map $ + 1

```

**Ballerina Output (transform_message_with_map_value_identifier.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json {
    var _var_0 = [1, 2, 3, 4];
    return _var_0.'map(element => element + 1);
}

```

## Map With Parameters Expression

**DataWeave Script (transform_message_with_map_with_parameters.dwl):**
```dataweave
%dw 1.0
%output application/json
---
["john", "peter", "matt"] map ((firstName, position) -> position ++ ":" ++ upper firstName)
```

**Ballerina Output (transform_message_with_map_with_parameters.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_();
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json {
    var _var_0 = ["john", "peter", "matt"];
    return _var_0.'map(element => _var_0.indexOf(element).toString() + ":" + element.toUpperAscii());
}

```

## Replace With Expression

**DataWeave Script (transform_message_with_replace_with.dwl):**
```dataweave
%dw 1.0
%output application/json
---
b: "admin123" replace /(\d+)/ with "ID"

```

**Ballerina Output (transform_message_with_replace_with.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_();
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json {
    string:RegExp _pattern_ = re `/(\d+)/`;
    var _var_0 = "admin123";
    return {"b": _pattern_.replace(_var_0, "ID")};
}

```

## Single Selector Expression

**DataWeave Script (transform_message_with_single_selector.dwl):**
```dataweave
%dw 1.0
%output application/json
%input payload application/json
---
{
	hail1: payload.resultSet1
}

```

**Ballerina Output (transform_message_with_single_selector.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = check _dwMethod0_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json|error {
    return {"hail1": check payload.resultSet1.ensureType(json)};
}

```

## Sizeof Expression

**DataWeave Script (transform_message_with_sizeof.dwl):**
```dataweave
%dw 1.0
%output application/json
%input payload application/json
---
{
	hail1: sizeOf [1,2,3,4]
}

```

**Ballerina Output (transform_message_with_sizeof.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json {
    var _var_0 = [1, 2, 3, 4];
    return {"hail1": _var_0.length()};
}

```

## String Return Expression

**DataWeave Script (transform_message_with_string_return.dwl):**
```dataweave
%dw 1.0
%output text/plain
---
"Hello World"

```

**Ballerina Output (transform_message_with_string_return.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

function _dwMethod0_(Context ctx) returns string {
    return "Hello World";
}

public function sampleFlow(Context ctx) {
    string _dwOutput_ = _dwMethod0_();
    ctx.payload = _dwOutput_;
}

```

## Type Coercion Date To Number Expression

**DataWeave Script (transform_message_with_type_coercion_date_to_number.dwl):**
```dataweave
%dw 1.0
%output application/json
---
{
  mydate1: |2005-06-02T15:10:16Z| as :number {unit: "seconds"},
  mydate2: |2005-06-02T15:10:16Z| as :number {unit: "milliseconds"},
  mydate3: |2005-06-02T15:10:16Z| as :number
}

```

**Ballerina Output (transform_message_with_type_coercion_date_to_number.bal):**
```ballerina
import ballerina/time;

public type Context record {|
    anydata payload = ();
|};

function _dwMethod0_(Context ctx) returns json|error {
    time:Utc _utcValue_ = check time:utcFromCivil(check time:civilFromString("2005-06-02T15:10:16Z"));
    return {"mydate1": check (check time:utcFromCivil(check time:civilFromString("2005-06-02T15:10:16Z")))[0].ensureType(json), "mydate2": check (_utcValue_[0] * 1000 + <int>(_utcValue_[1] * 1000)).ensureType(json), "mydate3": check (check time:utcFromCivil(check time:civilFromString("2005-06-02T15:10:16Z")))[0].ensureType(json)};
}

public function sampleFlow(Context ctx) {
    json _dwOutput_ = check _dwMethod0_();
    ctx.payload = _dwOutput_;
}

```

## Type Coercion Format Expression

**DataWeave Script (transform_message_with_type_coercion_format.dwl):**
```dataweave
%dw 1.0
%output application/json
---
{
    a: 1 as :string {format: "##,#"},
    b: now as :string {format: "yyyy-MM-dd"},
    c: true as :string
}

```

**Ballerina Output (transform_message_with_type_coercion_format.bal):**
```ballerina
import ballerina/jballerina.java;
import ballerina/time;

public type Context record {|
    anydata payload = ();
|};

public function getFormattedStringFromDate(string dateString, string format) returns string {
    handle localDateTime = getDateTime(parseInstant(java:fromString(dateString)),
            getZoneId(java:fromString("UTC")));
    return formatDateTime(localDateTime, getDateTimeFormatter(java:fromString(format))).toString();
}

public function parseInstant(handle instant) returns handle = @java:Method {
    'class: "java.time.Instant",
    name: "parse"
} external;

function _dwMethod0_(Context ctx) returns json|error {
    return {"a": intToString(1, "##,#"), "b": check getFormattedStringFromDate(getCurrentTimeString(), "yyyy-MM-dd").ensureType(json), "c": true.toString()};
}

public function formatDateTime(handle dateTime, handle formatter) returns handle = @java:Method {
    'class: "java.time.LocalDateTime"
} external;

public function getDateTimeFormatter(handle format) returns handle = @java:Method {
    'class: "java.time.format.DateTimeFormatter",
    name: "ofPattern",
    paramTypes: ["java.lang.String"]
} external;

public function getDateTime(handle instant, handle zoneId) returns handle = @java:Method {
    'class: "java.time.LocalDateTime",
    name: "ofInstant",
    paramTypes: ["java.time.Instant", "java.time.ZoneId"]
} external;

public function getZoneId(handle zoneId) returns handle = @java:Method {
    'class: "java.time.ZoneId",
    name: "of",
    paramTypes: ["java.lang.String"]
} external;

public function getFormattedStringFromNumber(handle formatObject, int value) returns handle = @java:Method {
    'class: "java.text.NumberFormat",
    name: "format",
    paramTypes: ["long"]
} external;

public function intToString(int intValue, string format) returns string {
    handle formatObj = newDecimalFormat(java:fromString(format));
    handle stringResult = getFormattedStringFromNumber(formatObj, intValue);
    return stringResult.toString();
}

public function sampleFlow(Context ctx) {
    json _dwOutput_ = check _dwMethod0_();
    ctx.payload = _dwOutput_;
}

public function newDecimalFormat(handle format) returns handle = @java:Constructor {
    'class: "java.text.DecimalFormat"
} external;

public function getCurrentTimeString() returns string {
    return time:utcToString(time:utcNow());
}

```

## Type Coercion Number Expression

**DataWeave Script (transform_message_with_type_coercion_number.dwl):**
```dataweave
%dw 1.0
%output application/json
---
"10" as :number

```

**Ballerina Output (transform_message_with_type_coercion_number.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = check _dwMethod0_();
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json|error {
    return check int:fromString("10");
}

```

## Type Coercion String Expression

**DataWeave Script (transform_message_with_type_coercion_string.dwl):**
```dataweave
%dw 1.0
%output text/plain
---
10 as :string

```

**Ballerina Output (transform_message_with_type_coercion_string.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

function _dwMethod0_(Context ctx) returns string {
    return 10.toString();
}

public function sampleFlow(Context ctx) {
    string _dwOutput_ = _dwMethod0_();
    ctx.payload = _dwOutput_;
}

```

## Type Coercion To Date Expression

**DataWeave Script (transform_message_with_type_coercion_to_date.dwl):**
```dataweave
%dw 1.0
%output application/json
---
{
 a: 1436287232 as :datetime,
 b: "2015-10-07 16:40:32.000" as :localdatetime {format: "yyyy-MM-dd HH:mm:ss.SSS"}
}

```

**Ballerina Output (transform_message_with_type_coercion_to_date.bal):**
```ballerina
import ballerina/jballerina.java;
import ballerina/time;

public type Context record {|
    anydata payload = ();
|};

public function UTC() returns handle = @java:FieldGet {
    'class: "java.time.ZoneOffset",
    name: "UTC"
} external;

function _dwMethod0_(Context ctx) returns json|error {
    return {"a": time:utcToString([1436287232, 0]), "b": check getDateFromFormattedString("2015-10-07 16:40:32.000", "yyyy-MM-dd HH:mm:ss.SSS")};
}

public function parseDateTime(handle date, handle formatter) returns handle = @java:Method {
    'class: "java.time.LocalDateTime",
    name: "parse",
    paramTypes: ["java.lang.CharSequence", "java.time.format.DateTimeFormatter"]
} external;

public function getDateFromFormattedString(string dateString, string format) returns time:Utc|error {
    handle localDateTime = parseDateTime(java:fromString(dateString), getDateTimeFormatter(java:fromString(format)));
    return check time:utcFromString(toInstant(localDateTime, UTC()).toString());
}

public function getDateTimeFormatter(handle format) returns handle = @java:Method {
    'class: "java.time.format.DateTimeFormatter",
    name: "ofPattern",
    paramTypes: ["java.lang.String"]
} external;

public function toInstant(handle localDateTime, handle zoneOffset) returns handle = @java:Method {
    'class: "java.time.LocalDateTime",
    paramTypes: ["java.time.ZoneOffset"]
} external;

public function sampleFlow(Context ctx) {
    json _dwOutput_ = check _dwMethod0_();
    ctx.payload = _dwOutput_;
}

```

## Upper Expression

**DataWeave Script (transform_message_with_upper.dwl):**
```dataweave
%dw 1.0
%output application/json
---
upper "apple"

```

**Ballerina Output (transform_message_with_upper.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_();
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json {
    return "apple".toUpperAscii();
}

```

## When Otherwise Expression

**DataWeave Script (transform_message_with_when_otherwise.dwl):**
```dataweave
%dw 1.0
%output application/json
%input payload application/json
---
{
  currency: "USD"
} when payload.country == "USA"
otherwise
{
      currency: "EUR"
}

```

**Ballerina Output (transform_message_with_when_otherwise.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = check _dwMethod0_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json|error {
    json _var_0;
    if check payload.country == "USA" {
        _var_0 = {"currency": "USD"};
    } else {
        _var_0 = {"currency": "EUR"};
    }
    return _var_0;
}

```

## When Otherwise Nested Expression

**DataWeave Script (transform_message_with_when_otherwise_nested.dwl):**
```dataweave
%dw 1.0
%output application/json
%input payload application/json
---
{
	currency: "USD"
} when payload.country =="USA"
otherwise
{
	currency: "GBP"
} when payload.country =="UK"
otherwise
{
	currency: "EUR"
}
```

**Ballerina Output (transform_message_with_when_otherwise_nested.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

public function sampleFlow(Context ctx) {
    json _dwOutput_ = check _dwMethod0_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(Context ctx) returns json|error {
    json _var_0;
    if check payload.country == "USA" {
        _var_0 = {"currency": "USD"};
    } else if check payload.country == "UK" {
        _var_0 = {"currency": "GBP"};
    } else {
        _var_0 = {"currency": "EUR"};
    }
    return _var_0;
}

```

