###### This markdown file is AUTO-GENERATED by the test suite. Do not modify manually. ######

# Supported Mule 3.x Components

- [Async](palette-item-mappings-v3.md#async)
- [Catch Exception Strategy](palette-item-mappings-v3.md#catch-exception-strategy)
- [Choice](palette-item-mappings-v3.md#choice)
- [Choice Exception Strategy](palette-item-mappings-v3.md#choice-exception-strategy)
- [Database Connector](palette-item-mappings-v3.md#database-connector)
- [Expression Component](palette-item-mappings-v3.md#expression-component)
- [First Successful](palette-item-mappings-v3.md#first-successful)
- [Flow](palette-item-mappings-v3.md#flow)
- [For Each](palette-item-mappings-v3.md#for-each)
- [Http Listener](palette-item-mappings-v3.md#http-listener)
- [Http Request](palette-item-mappings-v3.md#http-request)
- [Logger](palette-item-mappings-v3.md#logger)
- [Message Enricher](palette-item-mappings-v3.md#message-enricher)
- [Misc](palette-item-mappings-v3.md#misc)
- [Object To Json](palette-item-mappings-v3.md#object-to-json)
- [Object To String](palette-item-mappings-v3.md#object-to-string)
- [Poll](palette-item-mappings-v3.md#poll)
- [Quartz Connector](palette-item-mappings-v3.md#quartz-connector)
- [Reference Exception Strategy](palette-item-mappings-v3.md#reference-exception-strategy)
- [Scatter Gather](palette-item-mappings-v3.md#scatter-gather)
- [Session Variable](palette-item-mappings-v3.md#session-variable)
- [Set Payload](palette-item-mappings-v3.md#set-payload)
- [Sub Flow](palette-item-mappings-v3.md#sub-flow)
- [Transform Message](palette-item-mappings-v3.md#transform-message)
- [Variable](palette-item-mappings-v3.md#variable)
- [Vm Connector](palette-item-mappings-v3.md#vm-connector)
# Sample Input and Output (Mule 3.x)

The `mule-to-ballerina-migration-assistant` project includes sample input and output files to demonstrate the conversion process. These samples are located in the `mule/src/test/resources/mule/v3/blocks` directory.

## Async

- ### Simple Async

**Input (simple_async.xml):**
```xml
<mule xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">
    <flow name="mainFlow">
        <set-payload value="Hello" />
        <async>
            <logger level="INFO" message="Doing something in background: #[payload]" />
        </async>
        <logger level="INFO" message="Main flow continues immediately." />
    </flow>
</mule>

```
**Output (simple_async.bal):**
```ballerina
import ballerina/log;

public type Context record {|
    anydata payload = ();
|};

public function mainFlow(Context ctx) {

    // set payload
    string payload0 = "Hello";
    ctx.payload = payload0;

    // async operation
    _ = start async0(ctx);
    log:printInfo("Main flow continues immediately.");
}

public function async0(Context ctx) {
    log:printInfo(string `Doing something in background: ${ctx.payload.toString()}`);
}

```

## Catch Exception Strategy

- ### Basic Catch Exception Strategy

**Input (basic_catch_exception_strategy.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <flow name="demoFlow">
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
        <catch-exception-strategy doc:name="Catch Exception Strategy">
            <logger message="xxx: exception caught" level="INFO" doc:name="Logger"/>
            <logger message="xxx: end of catch flow reached" level="INFO" doc:name="Logger"/>
        </catch-exception-strategy>
    </flow>
</mule>

```
**Output (basic_catch_exception_strategy.bal):**
```ballerina
import ballerina/log;

public type Context record {|
    anydata payload = ();
|};

public function demoFlow(Context ctx) {
    do {
        log:printInfo("xxx: logger invoked via http end point");
    } on fail {
        log:printInfo("xxx: exception caught");
        log:printInfo("xxx: end of catch flow reached");
    }
}

```

- ### Catch Exception With Http Listener Source

**Input (catch_exception_with_http_listener_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
        <catch-exception-strategy doc:name="Catch Exception Strategy">
            <logger message="xxx: exception caught" level="INFO" doc:name="Logger"/>
            <logger message="xxx: end of catch flow reached" level="INFO" doc:name="Logger"/>
        </catch-exception-strategy>
    </flow>
</mule>

```
**Output (catch_exception_with_http_listener_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        do {
            log:printInfo("xxx: logger invoked via http end point");
        } on fail {
            log:printInfo("xxx: exception caught");
            log:printInfo("xxx: end of catch flow reached");
        }

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

## Choice

- ### Basic Choice

**Input (basic_choice.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:file="http://www.mulesoft.org/schema/mule/file" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/file http://www.mulesoft.org/schema/mule/file/current/mule-file.xsd">
    <flow name="muleProject">
        <set-variable variableName="age" value="#[29]" doc:name="Variable"/>
        <choice doc:name="Choice">
            <when expression="#[flowVars.age > 18]">
                <logger message="Adult detected: Age is #[flowVars.age] years." level="INFO" doc:name="Logger"/>
            </when>
            <otherwise>
                <logger message="Minor detected: Age is flowVars.age years." level="INFO" doc:name="Logger"/>
            </otherwise>
        </choice>
    </flow>
</mule>

```
**Output (basic_choice.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    int age?;
|};

public type Context record {|
    anydata payload = ();
    FlowVars flowVars = {};
|};

public function muleProject(Context ctx) {
    ctx.flowVars.age = 29;
    if ctx.flowVars.age > 18 {
        log:printInfo(string `Adult detected: Age is ${ctx.flowVars.age.toString()} years.`);
    } else {
        log:printInfo("Minor detected: Age is flowVars.age years.");
    }
}

```

- ### Choice With Http Listener Source

**Input (choice_with_http_listener_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:file="http://www.mulesoft.org/schema/mule/file" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/file http://www.mulesoft.org/schema/mule/file/current/mule-file.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="muleProject">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <set-variable variableName="marks" value="#[73]" doc:name="Variable"/>
        <choice doc:name="Choice">
            <when expression="#[flowVars.marks > 75]">
                <logger message="You have scored #[flowVars.marks]. Your grade is A." level="INFO" doc:name="Logger"/>
            </when>
            <when expression="#[flowVars.marks > 65]">
                <logger message="You have scored #[flowVars.marks]. Your grade is B." level="INFO" doc:name="Logger"/>
            </when>
            <when expression="#[flowVars.marks > 55]">
                <logger message="You have scored #[flowVars.marks]. Your grade is C." level="INFO" doc:name="Logger"/>
            </when>
            <otherwise>
                <logger message="You have scored #[flowVars.marks]. Your grade is F." level="INFO" doc:name="Logger"/>
            </otherwise>
        </choice>
    </flow>
</mule>

```
**Output (choice_with_http_listener_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type FlowVars record {|
    int marks?;
|};

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    FlowVars flowVars = {};
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        ctx.flowVars.marks = 73;
        if ctx.flowVars.marks > 75 {
            log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is A.`);
        } else if ctx.flowVars.marks > 65 {
            log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is B.`);
        } else if ctx.flowVars.marks > 55 {
            log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is C.`);
        } else {
            log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is F.`);
        }

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Choice With Multiple Conditions

**Input (choice_with_multiple_conditions.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:file="http://www.mulesoft.org/schema/mule/file" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/file http://www.mulesoft.org/schema/mule/file/current/mule-file.xsd">
    <flow name="muleProject">
        <set-variable variableName="marks" value="#[73]" doc:name="Variable"/>
        <choice doc:name="Choice">
            <when expression="#[flowVars.marks > 75]">
                <logger message="You have scored #[flowVars.marks]. Your grade is A." level="INFO" doc:name="Logger"/>
            </when>
            <when expression="#[flowVars.marks > 65]">
                <logger message="You have scored #[flowVars.marks]. Your grade is B." level="INFO" doc:name="Logger"/>
            </when>
            <when expression="#[flowVars.marks > 55]">
                <logger message="You have scored #[flowVars.marks]. Your grade is C." level="INFO" doc:name="Logger"/>
            </when>
            <otherwise>
                <logger message="You have scored #[flowVars.marks]. Your grade is F." level="INFO" doc:name="Logger"/>
            </otherwise>
        </choice>
    </flow>
</mule>

```
**Output (choice_with_multiple_conditions.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    int marks?;
|};

public type Context record {|
    anydata payload = ();
    FlowVars flowVars = {};
|};

public function muleProject(Context ctx) {
    ctx.flowVars.marks = 73;
    if ctx.flowVars.marks > 75 {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is A.`);
    } else if ctx.flowVars.marks > 65 {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is B.`);
    } else if ctx.flowVars.marks > 55 {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is C.`);
    } else {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is F.`);
    }
}

```

## Choice Exception Strategy

- ### Basic Choice Exception Strategy

**Input (basic_choice_exception_strategy.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <flow name="demoFlow">
        <logger message="xxx: main flow logger invoked" level="INFO" doc:name="Logger"/>
        <choice-exception-strategy doc:name="Choice Exception Strategy">
            <catch-exception-strategy doc:name="Catch Exception Strategy" when="#[exception.causedBy(java.lang.NullPointerException)]">
                <logger message="xxx: first catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
            <catch-exception-strategy doc:name="Catch Exception Strategy" when="#[exception.causedBy(java.lang.IllegalArgumentException) || exception.causedBy(java.lang.IllegalStateException)]">
                <logger message="xxx: second catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
            <catch-exception-strategy doc:name="Catch Exception Strategy">
                <logger message="xxx: generic catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
        </choice-exception-strategy>
    </flow>
</mule>

```
**Output (basic_choice_exception_strategy.bal):**
```ballerina
import ballerina/log;

public type Context record {|
    anydata payload = ();
|};

public function demoFlow(Context ctx) {
    do {
        log:printInfo("xxx: main flow logger invoked");
    } on fail error e {
        // TODO: if conditions may require some manual adjustments
        if e.message() == "java.lang.NullPointerException" {
            log:printInfo("xxx: first catch condition invoked");
        } else if e.message() == "java.lang.IllegalArgumentException" || e.message() == "java.lang.IllegalStateException" {
            log:printInfo("xxx: second catch condition invoked");
        } else {
            log:printInfo("xxx: generic catch condition invoked");
        }
    }
}

```

- ### Choice Exception With Http Listener Source

**Input (choice_exception_with_http_listener_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
        <choice-exception-strategy doc:name="Choice Exception Strategy">
            <catch-exception-strategy doc:name="Catch Exception Strategy" when="#[exception.causedBy(java.lang.NullPointerException)]">
                <logger message="xxx: first catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
            <catch-exception-strategy doc:name="Catch Exception Strategy" when="#[exception.causedBy(java.lang.IllegalArgumentException) || exception.causedBy(java.lang.IllegalStateException)]">
                <logger message="xxx: second catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
            <catch-exception-strategy doc:name="Catch Exception Strategy">
                <logger message="xxx: generic catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
        </choice-exception-strategy>
    </flow>
</mule>

```
**Output (choice_exception_with_http_listener_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        do {
            log:printInfo("xxx: logger invoked via http end point");
        } on fail error e {
            // TODO: if conditions may require some manual adjustments
            if e.message() == "java.lang.NullPointerException" {
                log:printInfo("xxx: first catch condition invoked");
            } else if e.message() == "java.lang.IllegalArgumentException" || e.message() == "java.lang.IllegalStateException" {
                log:printInfo("xxx: second catch condition invoked");
            } else {
                log:printInfo("xxx: generic catch condition invoked");
            }
        }

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

## Database Connector

- ### Basic Db Select

**Input (basic_db_select.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <db:mysql-config name="MySQL_Configuration" host="localhost" port="3306" user="root" password="admin123" database="test_db" doc:name="MySQL Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <db:select config-ref="MySQL_Configuration" doc:name="Database">
            <db:parameterized-query><![CDATA[SELECT * FROM users;]]></db:parameterized-query>
        </db:select>
    </flow>
</mule>

```
**Output (basic_db_select.bal):**
```ballerina
import ballerina/http;
import ballerina/sql;
import ballerinax/mysql;
import ballerinax/mysql.driver as _;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public type Record record {
};

mysql:Client MySQL_Configuration = check new ("localhost", "root", "admin123", "test_db", 3306);
public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};

        // database operation
        sql:ParameterizedQuery dbQuery0 = `SELECT * FROM users;`;
        stream<Record, sql:Error?> dbStream0 = MySQL_Configuration->query(dbQuery0);
        Record[] dbSelect0 = check from Record _iterator_ in dbStream0
            select _iterator_;
        ctx.payload = dbSelect0;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Db Select Query From Template

**Input (db_select_query_from_template.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <db:mysql-config name="MySQL_Configuration" host="localhost" port="3306" user="root" password="admin123" database="test_db" doc:name="MySQL Configuration"/>
    <db:template-query name="Template_Select_Query" doc:name="Template Query">
        <db:parameterized-query><![CDATA[SELECT * FROM users;]]></db:parameterized-query>
    </db:template-query>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <db:select config-ref="MySQL_Configuration" doc:name="Database">
            <db:template-query-ref name="Template_Select_Query"/>
        </db:select>
    </flow>
</mule>

```
**Output (db_select_query_from_template.bal):**
```ballerina
import ballerina/http;
import ballerina/sql;
import ballerinax/mysql;
import ballerinax/mysql.driver as _;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public type Record record {
};

mysql:Client MySQL_Configuration = check new ("localhost", "root", "admin123", "test_db", 3306);
sql:ParameterizedQuery Template_Select_Query = `SELECT * FROM users;`;
public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};

        // database operation
        sql:ParameterizedQuery dbQuery0 = Template_Select_Query;
        stream<Record, sql:Error?> dbStream0 = MySQL_Configuration->query(dbQuery0);
        Record[] dbSelect0 = check from Record _iterator_ in dbStream0
            select _iterator_;
        ctx.payload = dbSelect0;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Generic Db Select

**Input (generic_db_select.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd">
    <http:listener-config name="config" host="localhost" port="8081" basePath="/mule3" doc:name="HTTP Listener Configuration"/>
    <db:generic-config name="Generic_Database_Configuration" url="jdbc:postgresql://localhost:5432/bookstore" user="root" password="admin" doc:name="Generic Database Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/demo" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
        <db:select config-ref="Generic_Database_Configuration" doc:name="Database">
            <db:parameterized-query><![CDATA[SELECT * FROM users;]]></db:parameterized-query>
        </db:select>
    </flow>
</mule>

```
**Output (generic_db_select.bal):**
```ballerina
import ballerina/http;
import ballerina/log;
import ballerina/sql;
import ballerinax/java.jdbc;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public type Record record {
};

jdbc:Client Generic_Database_Configuration = check new ("jdbc:postgresql://localhost:5432/bookstore", "root", "admin");
public listener http:Listener config = new (8081, {host: "localhost"});

service /mule3 on config {
    resource function get demo(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");

        // database operation
        sql:ParameterizedQuery dbQuery0 = `SELECT * FROM users;`;
        stream<Record, sql:Error?> dbStream0 = Generic_Database_Configuration->query(dbQuery0);
        Record[] dbSelect0 = check from Record _iterator_ in dbStream0
            select _iterator_;
        ctx.payload = dbSelect0;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Oracle Db Select

**Input (oracle_db_select.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd">
    <http:listener-config name="config" host="localhost" port="8081" basePath="/mule3" doc:name="HTTP Listener Configuration"/>
    <db:oracle-config name="Oracle_Configuration" doc:name="Oracle Configuration" host="localhost" password="admin123" port="3306" user="root" instance="test_db"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/demo" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
        <db:select config-ref="Oracle_Configuration" doc:name="Database">
            <db:parameterized-query><![CDATA[SELECT * FROM users;]]></db:parameterized-query>
        </db:select>
    </flow>
</mule>

```
**Output (oracle_db_select.bal):**
```ballerina
import ballerina/http;
import ballerina/log;
import ballerina/sql;
import ballerinax/oracledb;
import ballerinax/oracledb.driver as _;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public type Record record {
};

oracledb:Client Oracle_Configuration = check new ("localhost", "root", "admin123", "test_db", 3306);
public listener http:Listener config = new (8081, {host: "localhost"});

service /mule3 on config {
    resource function get demo(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");

        // database operation
        sql:ParameterizedQuery dbQuery0 = `SELECT * FROM users;`;
        stream<Record, sql:Error?> dbStream0 = Oracle_Configuration->query(dbQuery0);
        Record[] dbSelect0 = check from Record _iterator_ in dbStream0
            select _iterator_;
        ctx.payload = dbSelect0;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

## Expression Component

- ### Simple Expression Component

**Input (simple_expression_component.xml):**
```xml
<mule xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">
    <flow name="combineFlowVarsAndPayloadFlow">
        <set-variable variableName="name" value="Alice"/>
        <set-payload value="Welcome"/>
        <expression-component>
            <![CDATA[
                flowVars.name = "Alice";
                payload = "Hello " + flowVars.name;
            ]]>
        </expression-component>
        <logger message="Message: #[payload]" level="INFO"/>
    </flow>
</mule>

```
**Output (simple_expression_component.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    string name?;
|};

public type Context record {|
    anydata payload = ();
    FlowVars flowVars = {};
|};

public function combineFlowVarsAndPayloadFlow(Context ctx) {
    ctx.flowVars.name = "Alice";

    // set payload
    string payload0 = "Welcome";
    ctx.payload = payload0;
    ctx.flowVars.name = "Alice";
    ctx.payload = "Hello " + ctx.flowVars.name;
    log:printInfo(string `Message: ${ctx.payload.toString()}`);
}

```

## First Successful

- ### Basic First Successful

**Input (basic_first_successful.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns:spring="http://www.springframework.org/schema/beans" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.9/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/3.9/mule-http.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">

    <http:listener-config name="http_listener" host="0.0.0.0" port="9090" doc:name="HTTP Listener config"/>

    <flow name="scatterGatherFlow">
        <http:listener config-ref="http_listener" path="/first_successful" doc:name="HTTP Listener"/>
        <first-successful doc:name="First Successful">
            <set-payload value="Route 0 completed" doc:name="Set Payload 1"/>
            <set-payload value="Route 1 completed" doc:name="Set Payload 2"/>
            <set-payload value="Route 2 completed" doc:name="Set Payload 3"/>
        </first-successful>
        <logger level="INFO" message="#[payload]" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_first_successful.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener http_listener = new (9090);

service / on http_listener {
    resource function default first_successful(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};

        // first-successful sequential route execution
        anydata firstSuccessfulResult0 = check firstSuccessful0(ctx);
        ctx.payload = firstSuccessfulResult0;

        log:printInfo(ctx.payload.toString());

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

public function firstSuccessful0(Context ctx) returns anydata|error {
    anydata|error r0 = firstSuccessfulRoute0(ctx);
    if r0 !is error {
        return r0;
    }
    anydata|error r1 = firstSuccessfulRoute1(ctx);
    if r1 !is error {
        return r1;
    }
    anydata|error r2 = firstSuccessfulRoute2(ctx);
    if r2 !is error {
        return r2;
    }
    return error("All routes failed", r2);
}

public function firstSuccessfulRoute2(Context ctx) returns anydata|error {
    // Route 2

    // set payload
    string payload2 = "Route 2 completed";
    ctx.payload = payload2;
    return ctx.payload;
}

public function firstSuccessfulRoute1(Context ctx) returns anydata|error {
    // Route 1

    // set payload
    string payload1 = "Route 1 completed";
    ctx.payload = payload1;
    return ctx.payload;
}

public function firstSuccessfulRoute0(Context ctx) returns anydata|error {
    // Route 0

    // set payload
    string payload0 = "Route 0 completed";
    ctx.payload = payload0;
    return ctx.payload;
}

```

## Flow

- ### Basic Flow

**Input (basic_flow.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_flow.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked via http end point");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Private Flow

**Input (private_flow.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
        <flow-ref name="demoPrivateFlow" doc:name="Flow Reference"/>
        <logger message="xxx: end of main flow" level="INFO" doc:name="Logger"/>
    </flow>
    <flow name="demoPrivateFlow">
        <logger message="xxx: private flow invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (private_flow.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked via http end point");
        demoPrivateFlow(ctx);
        log:printInfo("xxx: end of main flow");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

public function demoPrivateFlow(Context ctx) {
    log:printInfo("xxx: private flow invoked");
}

```

## For Each

- ### Basic For Each

**Input (basic_for_each.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:spring="http://www.springframework.org/schema/beans" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.9/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/3.9/mule-http.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">

    <http:listener-config name="HTTP_Listener_config" host="0.0.0.0" port="9090" doc:name="HTTP Listener Configuration"/>

    <flow name="muleDemoFlow">
        <http:listener path="/demo" config-ref="HTTP_Listener_config" allowedMethods="POST" doc:name="HTTP"/>
        <set-payload value='["Alice", "Bob", "Charlie"]' doc:name="Set Payload" mimeType="application/json"/>
        <foreach doc:name="For Each">
            <logger level="INFO" doc:name="Logger" message="Current item: #[payload]"/>
        </foreach>
    </flow>
</mule>

```
**Output (basic_for_each.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener HTTP_Listener_config = new (9090);

service / on HTTP_Listener_config {
    resource function post demo(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};

        // set payload
        string payload0 = "[\"Alice\", \"Bob\", \"Charlie\"]";
        ctx.payload = payload0;

        // foreach loop
        anydata originalPayload0 = ctx.payload;
        foreach anydata iterator0 in ctx.payload {
            ctx.payload = iterator0;
            log:printInfo(string `Current item: ${ctx.payload.toString()}`);
        }
        ctx.payload = originalPayload0;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

## Http Listener

- ### Allowed Resource Default Methods

**Input (allowed_resource_default_methods.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/demo"  doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (allowed_resource_default_methods.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function default demo(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Allowed Resource Get Method

**Input (allowed_resource_get_method.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="POST" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (allowed_resource_get_method.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function post .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Allowed Resource Multiple Methods

**Input (allowed_resource_multiple_methods.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET, POST, DELETE" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (allowed_resource_multiple_methods.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        return invokeEndPoint0(request);
    }

    resource function post .(http:Request request) returns http:Response|error {
        return invokeEndPoint0(request);
    }

    resource function delete .(http:Request request) returns http:Response|error {
        return invokeEndPoint0(request);
    }
}

public function invokeEndPoint0(http:Request request) returns http:Response|error {
    Context ctx = {inboundProperties: {request, response: new}};
    log:printInfo("xxx: logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Basic Http Listener

**Input (basic_http_listener.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081" basePath="/mule3" doc:name="HTTP Listener Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/demo" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_http_listener.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get demo(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Empty Absolute And Resource Paths

**Input (empty_absolute_and_resource_paths.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" />
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (empty_absolute_and_resource_paths.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service / on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Empty Absolute Path

**Input (empty_absolute_path.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/demo" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (empty_absolute_path.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service / on config {
    resource function get demo(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Empty Resource Path

**Input (empty_resource_path.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (empty_resource_path.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Http Listener Inbound Properties

**Input (http_listener_inbound_properties.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">

    <http:listener-config name="HTTP_Listener_Configuration" host="0.0.0.0" port="8081" doc:name="HTTP Listener Configuration" />
    <http:request-config name="HTTP_Request_Config" host="restcountries.com" port="443" protocol="HTTPS" doc:name="HTTP Request Configuration"/>

    <flow name="currency-api-flow">
        <http:listener config-ref="HTTP_Listener_Configuration" path="/proptest/{country}/v1" doc:name="HTTP" allowedMethods="GET"/>
        <set-variable variableName="queryParams" value="#[message.inboundProperties.'http.query.params']" doc:name="Set Query Params Variable"/>
        <set-variable variableName="city" value="#[message.inboundProperties.'http.query.params'.city]" doc:name="Set City Variable"/>
        <set-variable variableName="queryParams2" value="#[message.inboundProperties['http.query.params']]" doc:name="Set Query Params2 Variable"/>
        <set-variable variableName="city2" value="#[message.inboundProperties['http.query.params'].city]" doc:name="Set City2 Variable"/>
        <set-variable variableName="uriParams" value="#[message.inboundProperties.'http.uri.params']" doc:name="Set Uri Params Variable"/>
        <set-variable variableName="country" value="#[message.inboundProperties.'http.uri.params'.country]" doc:name="Set Country Variable"/>
        <set-variable variableName="unsupportedProperty" value="#[message.inboundProperties['unsupported.property']]" doc:name="Set Unsupported Property Variable"/>
        <set-variable variableName="unsupportedPropertyAccess" value="#[message.inboundProperties['unsupported.property'].city]" doc:name="Set Unsupported Property Access Variable"/>
        <set-variable variableName="httpMethod" value="#[message.inboundProperties.'http.method']" doc:name="Set Http Method Variable"/>
    </flow>
</mule>

```
**Output (http_listener_inbound_properties.bal):**
```ballerina
import ballerina/http;

public type FlowVars record {|
    map<string[]> queryParams?;
    string city?;
    map<string[]> queryParams2?;
    string city2?;
    map<string> uriParams?;
    string country?;
    anydata unsupportedProperty?;
    anydata unsupportedPropertyAccess?;
    anydata httpMethod?;
|};

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    FlowVars flowVars = {};
    InboundProperties inboundProperties;
|};

public listener http:Listener HTTP_Listener_Configuration = new (8081);

service / on HTTP_Listener_Configuration {
    resource function get proptest/[string country]/v1(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new, uriParams: {country}}};
        ctx.flowVars.queryParams = ctx.inboundProperties.request.getQueryParams();
        ctx.flowVars.city = ctx.inboundProperties.request.getQueryParamValue("city");
        ctx.flowVars.queryParams2 = ctx.inboundProperties.request.getQueryParams();
        ctx.flowVars.city2 = ctx.inboundProperties.request.getQueryParamValue("city");
        ctx.flowVars.uriParams = ctx.inboundProperties.uriParams;
        ctx.flowVars.country = ctx.inboundProperties.uriParams.get("country");
        ctx.flowVars.unsupportedProperty = ctx.inboundProperties["unsupported.property"];
        ctx.flowVars.unsupportedPropertyAccess = ctx.inboundProperties["unsupported.property"].city;
        ctx.flowVars.httpMethod = ctx.inboundProperties.request.method;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Http Listener With Localhost

**Input (http_listener_with_localhost.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="localhost" port="8081" basePath="/mule3" doc:name="HTTP Listener Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/demo" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (http_listener_with_localhost.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "localhost"});

service /mule3 on config {
    resource function get demo(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Missing Listener Config Reference

**Input (missing_listener_config_reference.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <!--    <http:listener-config name="config" host="0.0.0.0" port="8081" basePath="/mule3" doc:name="HTTP Listener Configuration"/>-->
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/demo" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (missing_listener_config_reference.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

// TODO: listener config ref 'config' not found. Using default base path '/'
service / on config {
    resource function get demo(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Query Params

**Input (query_params.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="demo"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/testquery" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
        <logger message="Path params - version: #[message.inboundProperties['http.query.params'].country], id: #[message.inboundProperties.'http.query.params'.city]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (query_params.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /demo on config {
    resource function get testquery(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");
        log:printInfo(string `Path params - version: ${ctx.inboundProperties.request.getQueryParamValue("country").toString()}, id: ${ctx.inboundProperties.request.getQueryParamValue("city").toString()}`);

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Resource Uri Params

**Input (resource_uri_params.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/{version}/demo/{id}" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
        <logger message="Path params - version: #[message.inboundProperties.'http.uri.params'.version], id: #[message.inboundProperties['http.uri.params'].id]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (resource_uri_params.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get [string version]/demo/[string id](http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new, uriParams: {version, id}}};
        log:printInfo("xxx: logger invoked");
        log:printInfo(string `Path params - version: ${ctx.inboundProperties.uriParams.get("version").toString()}, id: ${ctx.inboundProperties.uriParams.get("id").toString()}`);

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Special Characters In Resource Path

**Input (special_characters_in_resource_path.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule-3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/v-1/demo/1.0/main-contract/new" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (special_characters_in_resource_path.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule\-3 on config {
    resource function get v\-1/demo/'1\.0/main\-contract/'new(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

## Http Request

- ### Basic Http Request

**Input (basic_http_request.xml):**
```xml
<mule xmlns:jbossts="http://www.mulesoft.org/schema/mule/jbossts" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/jbossts http://www.mulesoft.org/schema/mule/jbossts/current/mule-jbossts.xsd">
    <http:request-config name="HTTP_Request_Config" host="jsonplaceholder.typicode.com" port="80" doc:name="HTTP Request Configuration" />
    <flow name="callExternalApiFlow">
        <http:request method="GET"
                      config-ref="HTTP_Request_Config"
                      path="/posts/latest"
                      doc:name="Call External API"/>
        <logger message="Received from external API: #[payload]" level="INFO" />
    </flow>
</mule>

```
**Output (basic_http_request.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type Context record {|
    anydata payload = ();
|};

public function callExternalApiFlow(Context ctx) {

    // http client request
    http:Client HTTP_Request_Config = check new ("jsonplaceholder.typicode.com:80");
    http:Response clientResult0 = check HTTP_Request_Config->/posts/latest.get();
    ctx.payload = check clientResult0.getJsonPayload();
    log:printInfo(string `Received from external API: ${ctx.payload.toString()}`);
}

```

- ### Http Request Path With Special Characters

**Input (http_request_path_with_special_characters.xml):**
```xml
<mule xmlns:jbossts="http://www.mulesoft.org/schema/mule/jbossts" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/jbossts http://www.mulesoft.org/schema/mule/jbossts/current/mule-jbossts.xsd">
    <http:request-config name="HTTP_Request_Config" host="jsonplaceholder.typicode.com" port="80" doc:name="HTTP Request Configuration" />
    <flow name="callExternalApiFlow">
        <http:request method="GET"
                      config-ref="HTTP_Request_Config"
                      path="/car-posts/12/honda-civic/991/1.1/latest"
                      doc:name="Call External API"/>
        <logger message="Received from external API: #[payload]" level="INFO" />
    </flow>
</mule>

```
**Output (http_request_path_with_special_characters.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type Context record {|
    anydata payload = ();
|};

public function callExternalApiFlow(Context ctx) {

    // http client request
    http:Client HTTP_Request_Config = check new ("jsonplaceholder.typicode.com:80");
    http:Response clientResult0 = check HTTP_Request_Config->/car\-posts/'12/honda\-civic/'991/'1\.1/latest.get();
    ctx.payload = check clientResult0.getJsonPayload();
    log:printInfo(string `Received from external API: ${ctx.payload.toString()}`);
}

```

- ### Http Request With Http Source

**Input (http_request_with_http_source.xml):**
```xml
<mule xmlns:jbossts="http://www.mulesoft.org/schema/mule/jbossts" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/jbossts http://www.mulesoft.org/schema/mule/jbossts/current/mule-jbossts.xsd">
    <http:listener-config name="HTTP_Listener_Config" host="0.0.0.0" port="8081" doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <http:request-config name="HTTP_Request_Config" host="jsonplaceholder.typicode.com" port="80" doc:name="HTTP Request Configuration" />
    <flow name="callExternalApiFlow">
        <http:listener config-ref="HTTP_Listener_Config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <http:request method="GET"
                      config-ref="HTTP_Request_Config"
                      path="/posts/latest"
                      doc:name="Call External API"/>
        <logger message="Received from external API: #[payload]" level="INFO" />
    </flow>
</mule>

```
**Output (http_request_with_http_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener HTTP_Listener_Config = new (8081);

service /mule3 on HTTP_Listener_Config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};

        // http client request
        http:Client HTTP_Request_Config = check new ("jsonplaceholder.typicode.com:80");
        http:Response clientResult0 = check HTTP_Request_Config->/posts/latest.get();
        ctx.payload = check clientResult0.getJsonPayload();
        log:printInfo(string `Received from external API: ${ctx.payload.toString()}`);

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

## Logger

- ### Basic Logger

**Input (basic_logger.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: first logger invoked" level="INFO" doc:name="Logger"/>
        <logger message="xxx: second logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_logger.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: first logger invoked");
        log:printInfo("xxx: second logger invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Logger Levels

**Input (logger_levels.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: INFO level logger invoked" level="INFO" doc:name="Logger"/>
        <logger message="xxx: DEBUG level logger invoked" level="DEBUG" doc:name="Logger"/>
        <logger message="xxx: ERROR level logger invoked" level="ERROR" doc:name="Logger"/>
        <logger message="xxx: WARN level logger invoked" level="WARN" doc:name="Logger"/>
        <logger message="xxx: TRACE level logger invoked" level="TRACE" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (logger_levels.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: INFO level logger invoked");
        log:printDebug("xxx: DEBUG level logger invoked");
        log:printError("xxx: ERROR level logger invoked");
        log:printWarn("xxx: WARN level logger invoked");
        log:printInfo("xxx: TRACE level logger invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

## Message Enricher

- ### Empty Message Enricher

**Input (empty_message_enricher.xml):**
```xml
<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">

    <flow name="variableEnricherFlow">
        <set-variable variableName="userId" value="st455u" doc:name="Variable"/>
        <set-variable variableName="enrichedUserId" value="null" doc:name="Variable"/>
        <enricher source="#[flowVars.userId]" target="#[flowVars.enrichedUserId]" doc:name="Message Enricher">
        </enricher>
        <logger message="User ID: #[flowVars.userId], Enriched User ID: #[flowVars.enrichedUserId]" level="INFO" doc:name="Logger"/>
    </flow>

</mule>

```
**Output (empty_message_enricher.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    string userId?;
    string enrichedUserId?;
|};

public type Context record {|
    anydata payload = ();
    FlowVars flowVars = {};
|};

public function variableEnricherFlow(Context ctx) {
    ctx.flowVars.userId = "st455u";
    ctx.flowVars.enrichedUserId = "null";
    ctx.flowVars.enrichedUserId = ctx.flowVars.userId;
    log:printInfo(string `User ID: ${ctx.flowVars.userId.toString()}, Enriched User ID: ${ctx.flowVars.enrichedUserId.toString()}`);
}

```

- ### Enricher With Inside Flow Reference

**Input (enricher_with_inside_flow_reference.xml):**
```xml
<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">

    <flow name="variableEnricherFlow">
        <set-variable variableName="userId" value="st455u" doc:name="Variable"/>
        <set-variable variableName="enrichedUserId" value="null" doc:name="Variable"/>
        <enricher source="#[flowVars.userId]" target="#[flowVars.enrichedUserId]" doc:name="Message Enricher">
            <flow-ref name="flow1" doc:name="Flow Reference"/>
        </enricher>
        <logger message="User ID: #[flowVars.userId], Enriched User ID: #[flowVars.enrichedUserId]" level="INFO" doc:name="Logger"/>
    </flow>
    <flow name="flow1">
        <logger message="xxx: flow1 starting logger invkoed" level="INFO" doc:name="Logger"/>
        <logger message="xxx: end of flow1 reached" level="INFO" doc:name="Logger"/>
    </flow>

</mule>

```
**Output (enricher_with_inside_flow_reference.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    string userId?;
    string enrichedUserId?;
|};

public type Context record {|
    anydata payload = ();
    FlowVars flowVars = {};
|};

public function variableEnricherFlow(Context ctx) {
    ctx.flowVars.userId = "st455u";
    ctx.flowVars.enrichedUserId = "null";
    ctx.flowVars.enrichedUserId = enricher0(ctx.clone());
    log:printInfo(string `User ID: ${ctx.flowVars.userId.toString()}, Enriched User ID: ${ctx.flowVars.enrichedUserId.toString()}`);
}

public function enricher0(Context ctx) returns string? {
    flow1(ctx);
    return ctx.flowVars.userId;
}

public function flow1(Context ctx) {
    log:printInfo("xxx: flow1 starting logger invkoed");
    log:printInfo("xxx: end of flow1 reached");
}

```

- ### Enricher With Inside Logger

**Input (enricher_with_inside_logger.xml):**
```xml
<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">

    <flow name="variableEnricherFlow">
        <set-variable variableName="userId" value="st455u" doc:name="Variable"/>
        <set-variable variableName="enrichedUserId" value="null" doc:name="Variable"/>
        <enricher source="#[flowVars.userId]" target="#[flowVars.enrichedUserId]" doc:name="Message Enricher">
            <logger message="xxx: logger inside the message enricher invoked" level="INFO" doc:name="Logger"/>
        </enricher>
        <logger message="User ID: #[flowVars.userId], Enriched User ID: #[flowVars.enrichedUserId]" level="INFO" doc:name="Logger"/>
    </flow>

</mule>

```
**Output (enricher_with_inside_logger.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    string userId?;
    string enrichedUserId?;
|};

public type Context record {|
    anydata payload = ();
    FlowVars flowVars = {};
|};

public function variableEnricherFlow(Context ctx) {
    ctx.flowVars.userId = "st455u";
    ctx.flowVars.enrichedUserId = "null";
    ctx.flowVars.enrichedUserId = enricher0(ctx.clone());
    log:printInfo(string `User ID: ${ctx.flowVars.userId.toString()}, Enriched User ID: ${ctx.flowVars.enrichedUserId.toString()}`);
}

public function enricher0(Context ctx) returns string? {
    log:printInfo("xxx: logger inside the message enricher invoked");
    return ctx.flowVars.userId;
}

```

## Misc

- ### External Property Access In Message

**Input (external_property_access_in_message.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:json="http://www.mulesoft.org/schema/mule/json"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd">
    <http:listener-config name="HTTP_Config" host="0.0.0.0" port="${http.port}" basePath="prop-access" doc:name="HTTP Listener Configuration"/>
    <db:mysql-config name="MySQL_Config" host="${db.host}" port="${db.port}" user="${db.user}" password="${db.password}" doc:name="MySQL Configuration" database="${db.database}"/>
    <http:listener-config name="Listener_Config"  host="0.0.0.0" port="8081" doc:name="HTTP Listener Configuration"/>
    <flow name="myFlow">
        <http:listener config-ref="Listener_Config" path="/test" allowedMethods="GET" doc:name="HTTP"/>
        <set-variable variableName="dbConnectionString" value="#['${http.host}' + ':' + '${http.port}']" doc:name="Set DB Connection String"/>
        <logger message="App running on port: ${http.port}" level="INFO" doc:name="Log App Running Port"/>
        <db:select config-ref="MySQL_Config" doc:name="Database">
            <db:parameterized-query/>
        </db:select>
        <logger message=" Welcome, ${user.firstName} ${user.lastName}. Your account balance is ${user.balance}" level="INFO" doc:name="Logger Welcome Message"/>
    </flow>
</mule>

```
**Output (external_property_access_in_message.bal):**
```ballerina
import ballerina/http;
import ballerina/log;
import ballerina/sql;
import ballerinax/mysql;
import ballerinax/mysql.driver as _;

public type FlowVars record {|
    anydata dbConnectionString?;
|};

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    FlowVars flowVars = {};
    InboundProperties inboundProperties;
|};

public type Record record {
};

configurable string http_host = ?;
configurable string http_port = ?;
configurable string user_firstName = ?;
configurable string user_lastName = ?;
configurable string user_balance = ?;
configurable string db_host = ?;
configurable string db_user = ?;
configurable string db_password = ?;
configurable string db_database = ?;
configurable string db_port = ?;
mysql:Client MySQL_Config = check new (db_host, db_user, db_password, db_database, check int:fromString(db_port));
public listener http:Listener HTTP_Config = new (check int:fromString(http_port));
public listener http:Listener Listener_Config = new (8081);

service / on Listener_Config {
    resource function get test(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        ctx.flowVars.dbConnectionString = http_host + ":" + http_port;
        log:printInfo(string `App running on port: ${http_port}`);

        // database operation
        sql:ParameterizedQuery dbQuery0 = ``;
        stream<Record, sql:Error?> dbStream0 = MySQL_Config->query(dbQuery0);
        Record[] dbSelect0 = check from Record _iterator_ in dbStream0
            select _iterator_;
        ctx.payload = dbSelect0;
        log:printInfo(string ` Welcome, ${user_firstName} ${user_lastName}. Your account balance is ${user_balance}`);

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

## Object To Json

- ### Basic Object To Json

**Input (basic_object_to_json.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <db:mysql-config name="MySQL_Configuration" host="localhost" port="3306" user="root" password="admin123" database="test_db" doc:name="MySQL Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <db:select config-ref="MySQL_Configuration" doc:name="Database">
            <db:parameterized-query><![CDATA[SELECT * FROM users;]]></db:parameterized-query>
        </db:select>
        <json:object-to-json-transformer doc:name="Object to JSON"/>
    </flow>
</mule>

```
**Output (basic_object_to_json.bal):**
```ballerina
import ballerina/http;
import ballerina/sql;
import ballerinax/mysql;
import ballerinax/mysql.driver as _;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public type Record record {
};

mysql:Client MySQL_Configuration = check new ("localhost", "root", "admin123", "test_db", 3306);
public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};

        // database operation
        sql:ParameterizedQuery dbQuery0 = `SELECT * FROM users;`;
        stream<Record, sql:Error?> dbStream0 = MySQL_Configuration->query(dbQuery0);
        Record[] dbSelect0 = check from Record _iterator_ in dbStream0
            select _iterator_;
        ctx.payload = dbSelect0;

        // json transformation
        ctx.payload = ctx.payload.toJson();

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

## Object To String

- ### Basic Object To String

**Input (basic_object_to_string.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <db:mysql-config name="MySQL_Configuration" host="localhost" port="3306" user="root" password="admin123" database="test_db" doc:name="MySQL Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <db:select config-ref="MySQL_Configuration" doc:name="Database">
            <db:parameterized-query><![CDATA[SELECT * FROM users;]]></db:parameterized-query>
        </db:select>
        <object-to-string-transformer doc:name="Object to String"/>
    </flow>
</mule>

```
**Output (basic_object_to_string.bal):**
```ballerina
import ballerina/http;
import ballerina/sql;
import ballerinax/mysql;
import ballerinax/mysql.driver as _;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public type Record record {
};

mysql:Client MySQL_Configuration = check new ("localhost", "root", "admin123", "test_db", 3306);
public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};

        // database operation
        sql:ParameterizedQuery dbQuery0 = `SELECT * FROM users;`;
        stream<Record, sql:Error?> dbStream0 = MySQL_Configuration->query(dbQuery0);
        Record[] dbSelect0 = check from Record _iterator_ in dbStream0
            select _iterator_;
        ctx.payload = dbSelect0;

        // string transformation
        ctx.payload = ctx.payload.toString();

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

## Poll

- ### Simple-Poll

**Input (simple-poll.xml):**
```xml
<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:schedulers="http://www.mulesoft.org/schema/mule/schedulers" xmlns:file="http://www.mulesoft.org/schema/mule/file"
      xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:quartz="http://www.mulesoft.org/schema/mule/quartz"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/file http://www.mulesoft.org/schema/mule/file/current/mule-file.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.9/mule.xsd
http://www.mulesoft.org/schema/mule/quartz http://www.mulesoft.org/schema/mule/quartz/3.9/mule-quartz.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/schedulers http://www.mulesoft.org/schema/mule/schedulers/current/mule-schedulers.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <flow name="pollFlow">
        <poll doc:name="Poll">
            <fixed-frequency-scheduler frequency="5000"/>
        </poll>
        <logger level="INFO" doc:name="Logger" message="xxx: polling triggered"/>
    </flow>
</mule>

```
**Output (simple-poll.bal):**
```ballerina
import ballerina/log;
import ballerina/task;

public type Context record {|
    anydata payload = ();
|};

class PollJob {
    *task:Job;

    public function execute() {
        log:printInfo("xxx: polling triggered");
    }
}

public function main() returns error? {
    task:JobId id = check task:scheduleJobRecurByFrequency(new PollJob(), 1.0);
}

```

## Quartz Connector

- ### Basic Quartz-Connector

**Input (basic_quartz-connector.xml):**
```xml
<mule xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:quartz="http://www.mulesoft.org/schema/mule/quartz"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.9/mule.xsd
http://www.mulesoft.org/schema/mule/quartz http://www.mulesoft.org/schema/mule/quartz/3.9/mule-quartz.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">
    <flow name="schedulerFlow">
        <quartz:inbound-endpoint jobName="schedulerJob" repeatInterval="5000" doc:name="Quartz">
            <quartz:event-generator-job/>
        </quartz:inbound-endpoint>
        <logger level="INFO" message="Scheduler triggered]" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_quartz-connector.bal):**
```ballerina
import ballerina/log;
import ballerina/task;

public type Context record {|
    anydata payload = ();
|};

class schedulerJob {
    *task:Job;

    public function execute() {
        log:printInfo("Scheduler triggered]");
    }
}

public function main() returns error? {
    task:JobId id = check task:scheduleJobRecurByFrequency(new schedulerJob(), 5.0);
}

```

## Reference Exception Strategy

- ### Basic Reference Exception Strategy

**Input (basic_reference_exception_strategy.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <catch-exception-strategy name="catch-exception-strategy">
        <logger level="INFO" doc:name="Logger" message="xxx: inside catch exception strategy"/>
    </catch-exception-strategy>
    <flow name="muleProject">
        <logger level="INFO" doc:name="Logger" message="xxx: end of flow reached"/>
        <exception-strategy ref="catch-exception-strategy" doc:name="Reference Exception Strategy"/>
    </flow>
</mule>

```
**Output (basic_reference_exception_strategy.bal):**
```ballerina
import ballerina/log;

public type Context record {|
    anydata payload = ();
|};

public function muleProject(Context ctx) {
    do {
        log:printInfo("xxx: end of flow reached");
    } on fail error e {
        catch\-exception\-strategy(ctx, e);
    }
}

public function catch\-exception\-strategy(Context ctx, error e) {
    log:printInfo("xxx: inside catch exception strategy");
}

```

- ### Reference Exception With Http Listener Source

**Input (reference_exception_with_http_listener_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="httpConfig" host="0.0.0.0" port="8081" basePath="/" doc:name="HTTP Listener Configuration"/>
    <catch-exception-strategy name="catch-exception-strategy">
        <logger level="INFO" doc:name="Logger" message="xxx: inside catch exception strategy"/>
    </catch-exception-strategy>
    <flow name="muleProject">
        <http:listener config-ref="httpConfig" path="/" doc:name="HTTP" allowedMethods="GET"/>
        <logger level="INFO" doc:name="Logger" message="xxx: end of flow reached"/>
        <exception-strategy ref="catch-exception-strategy" doc:name="Reference Exception Strategy"/>
    </flow>
</mule>

```
**Output (reference_exception_with_http_listener_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener httpConfig = new (8081);

service / on httpConfig {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        do {
            log:printInfo("xxx: end of flow reached");
        } on fail error e {
            catch\-exception\-strategy(ctx, e);
        }

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

public function catch\-exception\-strategy(Context ctx, error e) {
    log:printInfo("xxx: inside catch exception strategy");
}

```

## Scatter Gather

- ### Basic Scatter-Gather

**Input (basic_scatter-gather.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.9/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/3.9/mule-http.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">
    <http:listener-config name="HTTP_Listener_config" host="0.0.0.0" port="9090" doc:name="HTTP Listener config"/>
    <flow name="scatterGatherFlow">
        <http:listener config-ref="HTTP_Listener_config" path="/scatter" doc:name="HTTP Listener"/>
        <scatter-gather doc:name="Scatter-Gather">
            <set-payload value="Route 1 completed" doc:name="Set Payload 1"/>
            <set-payload value="Route 2 completed" doc:name="Set Payload 2"/>
            <set-payload value="Route 3 completed" doc:name="Set Payload 3"/>
        </scatter-gather>
        <logger level="INFO" message="#[payload]" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_scatter-gather.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener HTTP_Listener_config = new (9090);

service / on HTTP_Listener_config {
    resource function default scatter(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};

        // scatter-gather parallel execution
        fork {
            worker R0 returns anydata|error {
                // Route 0

                // set payload
                string payload0 = "Route 1 completed";
                ctx.payload = payload0;
                return ctx.payload;
            }
            worker R1 returns anydata|error {
                // Route 1

                // set payload
                string payload1 = "Route 2 completed";
                ctx.payload = payload1;
                return ctx.payload;
            }
            worker R2 returns anydata|error {
                // Route 2

                // set payload
                string payload2 = "Route 3 completed";
                ctx.payload = payload2;
                return ctx.payload;
            }
        }

        // wait for all workers to complete
        map<anydata|error> workerResults0 = wait {R0, R1, R2};
        map<anydata> scatterGatherResults0 = workerResults0.entries().'map(e => wrapRouteError(e[0], e[1])).'map(m => check m);
        ctx.payload = scatterGatherResults0;

        log:printInfo(ctx.payload.toString());

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

public function wrapRouteError(string key, anydata|error value) returns anydata|error {
    if value is error {
        return error(string `Error in Route ${key}: ${value.message()}`, value);
    }
    return value;
}

```

## Session Variable

- ### Basic Set Session Variable

**Input (basic_set_session_variable.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:json="http://www.mulesoft.org/schema/mule/json"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd">
    <flow name="myFlow">
        <logger message="xxx: flow starting logger invoked" level="INFO" doc:name="Logger"/>
        <set-session-variable variableName="day" value="21" doc:name="Session Variable"/>
        <set-session-variable variableName="month" value="July" doc:name="Session Variable"/>
        <set-session-variable variableName="from" value="2025" doc:name="Session Variable"/>
        <logger message="Session variables are: day - #[sessionVars.day], month - #[sessionVars.month], from - #[sessionVars['from']]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_set_session_variable.bal):**
```ballerina
import ballerina/log;

public type SessionVars record {|
    string day?;
    string month?;
    string 'from?;
|};

public type Context record {|
    anydata payload = ();
    SessionVars sessionVars = {};
|};

public function myFlow(Context ctx) {
    log:printInfo("xxx: flow starting logger invoked");
    ctx.sessionVars.day = "21";
    ctx.sessionVars.month = "July";
    ctx.sessionVars.'from = "2025";
    log:printInfo(string `Session variables are: day - ${ctx.sessionVars.day.toString()}, month - ${ctx.sessionVars.month.toString()}, from - ${ctx.sessionVars.'from.toString()}`);
}

```

- ### Set Session Variable With Http Source

**Input (set_session_variable_with_http_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:json="http://www.mulesoft.org/schema/mule/json"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd">
    <http:listener-config name="HTTP_Config" host="0.0.0.0" port="8081" basePath="/mule3" doc:name="HTTP Listener Config"/>
    <flow name="sessionVarExampleFlow">
        <!-- HTTP Listener as the source -->
        <http:listener config-ref="HTTP_Config" path="/session" allowedMethods="GET" doc:name="HTTP Listener"/>

        <!-- Set Session Variable -->
        <set-session-variable variableName="sessionVarExample" value="Initial Value" doc:name="Set Session Variable"/>

        <!-- Log Initial Session Variable -->
        <logger message="Session Variable (Initial): #[sessionVars.sessionVarExample]" level="INFO" doc:name="Logger Initial"/>

        <!-- Modify Session Variable -->
        <set-session-variable variableName="sessionVarExample" value="Modified Value" doc:name="Modify Session Variable"/>

        <!-- Log Modified Session Variable -->
        <logger message="Session Variable (Modified): #[sessionVars.sessionVarExample]" level="INFO" doc:name="Logger Modified"/>

        <set-payload value="{&quot;message&quot;:&quot;Check logs for session variable values&quot;}" doc:name="Set JSON Response"/>
    </flow>
</mule>

```
**Output (set_session_variable_with_http_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type SessionVars record {|
    string sessionVarExample?;
|};

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    SessionVars sessionVars = {};
    InboundProperties inboundProperties;
|};

public listener http:Listener HTTP_Config = new (8081);

service /mule3 on HTTP_Config {
    resource function get session(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        ctx.sessionVars.sessionVarExample = "Initial Value";
        log:printInfo(string `Session Variable (Initial): ${ctx.sessionVars.sessionVarExample.toString()}`);
        ctx.sessionVars.sessionVarExample = "Modified Value";
        log:printInfo(string `Session Variable (Modified): ${ctx.sessionVars.sessionVarExample.toString()}`);

        // set payload
        string payload0 = "{\"message\":\"Check logs for session variable values\"}";
        ctx.payload = payload0;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Simple Remove Session Variable

**Input (simple_remove_session_variable.xml):**
```xml
<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">
    <flow name="weatherServiceFlow">
        <set-session-variable variableName="greeting" value="#['hello session']" doc:name="Session Variable"/>
        <set-session-variable variableName="from" value="#['USA']" doc:name="Session Variable"/>
        <remove-session-variable variableName="greeting" doc:name="Session Variable"/>
        <remove-session-variable variableName="from" doc:name="Session Variable"/>
    </flow>
</mule>

```
**Output (simple_remove_session_variable.bal):**
```ballerina
public type SessionVars record {|
    string greeting?;
    string 'from?;
|};

public type Context record {|
    anydata payload = ();
    SessionVars sessionVars = {};
|};

public function weatherServiceFlow(Context ctx) {
    ctx.sessionVars.greeting = "hello session";
    ctx.sessionVars.'from = "USA";
    ctx.sessionVars.greeting = ();
    ctx.sessionVars.'from = ();
}

```

- ### Updating Same Session Variable

**Input (updating_same_session_variable.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:json="http://www.mulesoft.org/schema/mule/json"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd">
    <flow name="myFlow">
        <logger message="xxx: flow starting logger invoked" level="INFO" doc:name="Logger"/>
        <set-session-variable variableName="sessionVar1" value="initial value" doc:name="Session Variable"/>
        <set-session-variable variableName="sessionVar1" value="updated value" doc:name="Session Variable"/>
        <logger message="xxx: end of flow reached" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (updating_same_session_variable.bal):**
```ballerina
import ballerina/log;

public type SessionVars record {|
    string sessionVar1?;
|};

public type Context record {|
    anydata payload = ();
    SessionVars sessionVars = {};
|};

public function myFlow(Context ctx) {
    log:printInfo("xxx: flow starting logger invoked");
    ctx.sessionVars.sessionVar1 = "initial value";
    ctx.sessionVars.sessionVar1 = "updated value";
    log:printInfo("xxx: end of flow reached");
}

```

## Set Payload

- ### Basic Set Payload

**Input (basic_set_payload.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <set-payload value="Hello world!" doc:name="Set Payload"/>
    </flow>
</mule>

```
**Output (basic_set_payload.bal):**
```ballerina
import ballerina/http;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};

        // set payload
        string payload0 = "Hello world!";
        ctx.payload = payload0;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Multiple Set Payloads

**Input (multiple_set_payloads.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <set-payload value="First payload" doc:name="Set Payload"/>
        <set-payload value="Second payload" doc:name="Set Payload"/>
        <set-payload value="Third payload" doc:name="Set Payload"/>
    </flow>
</mule>

```
**Output (multiple_set_payloads.bal):**
```ballerina
import ballerina/http;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};

        // set payload
        string payload0 = "First payload";
        ctx.payload = payload0;

        // set payload
        string payload1 = "Second payload";
        ctx.payload = payload1;

        // set payload
        string payload2 = "Third payload";
        ctx.payload = payload2;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

## Sub Flow

- ### Basic Sub Flow

**Input (basic_sub_flow.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
        <flow-ref name="demoSub_Flow" doc:name="Flow Reference"/>
        <logger message="xxx: logger after flow reference invoked" level="INFO" doc:name="Logger"/>
    </flow>
    <sub-flow name="demoSub_Flow">
        <logger message="xxx: sub flow logger invoked" level="INFO" doc:name="Logger"/>
        <set-payload value="This is a sub flow set-payload call" doc:name="Set Payload"/>
    </sub-flow>
</mule>

```
**Output (basic_sub_flow.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        log:printInfo("xxx: logger invoked via http end point");
        demoSub_Flow(ctx);
        log:printInfo("xxx: logger after flow reference invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

public function demoSub_Flow(Context ctx) {
    log:printInfo("xxx: sub flow logger invoked");

    // set payload
    string payload0 = "This is a sub flow set-payload call";
    ctx.payload = payload0;
}

```

## Transform Message

See [DataWeave Samples (Mule 3.x)](dataweave-mappings-v3.md) for more details on Dataweave conversions.

- ### Transform Message With Components

**Input (transform_message_with_components.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw" xmlns:metadata="http://www.mulesoft.org/schema/mule/metadata" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081" basePath="/foo" doc:name="HTTP Listener Configuration"/>
    <flow name="mule6demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <dw:transform-message>
            <dw:input-payload mimeType="application/json"/>
            <dw:set-variable variableName="myVariable" resource="mule/v3/blocks/transform-message/dataweave-files/transform_message_with_components.dwl"/>
            <dw:set-payload resource="mule/v3/blocks/transform-message/dataweave-files/transform_message_with_components.dwl"/>
            <dw:set-session-variable variableName="mySessionVariable" resource="mule/v3/blocks/transform-message/dataweave-files/transform_message_with_components.dwl"/>
        </dw:transform-message>
    </flow>
</mule>

```
**Output (transform_message_with_components.bal):**
```ballerina
import ballerina/http;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /foo on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        json myVariable = _dwMethod0_(ctx.payload.toJson());
        json _dwOutput_ = _dwMethod0_(ctx.payload.toJson());
        json mySessionVariable = _dwMethod0_(ctx.payload.toJson());
        ctx.payload = _dwOutput_;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

function _dwMethod0_(json payload) returns json {
    return "apple".toUpperAscii();
}

```

- ### Transform Message With Simple Value

**Input (transform_message_with_simple_value.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw" xmlns:metadata="http://www.mulesoft.org/schema/mule/metadata" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081" basePath="/foo" doc:name="HTTP Listener Configuration"/>
    <flow name="mule6demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <dw:transform-message doc:name="Transform Message" metadata:id="7ac8bde9-bc67-492b-b681-45be71ec7e83">
            <dw:input-payload mimeType="application/java"/>
            <dw:set-payload><![CDATA[%dw 1.0
%output application/json
%input payload application/json
%var conversionRate=13.15
---
{s1: "Hello World", s2: 'Hello World', n: 1.23, b: true, a:[1,2,3], o:{ name:  "Anne" }}]]></dw:set-payload>
        </dw:transform-message>
    </flow>
</mule>

```
**Output (transform_message_with_simple_value.bal):**
```ballerina
import ballerina/http;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /foo on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        json _dwOutput_ = check _dwMethod0_(ctx.payload.toJson());
        ctx.payload = _dwOutput_;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

function _dwMethod0_(json payload) returns json|error {
    float conversionRate = 13.15;
    return {"s1": "Hello World", "s2": "Hello World", "n": 1.23, "b": true, "a": check [1, 2, 3].ensureType(json), "o": check {"name": "Anne"}.ensureType(json)};
}

```

- ### Transform Message With Unsupported Components

**Input (transform_message_with_unsupported_components.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw" xmlns:metadata="http://www.mulesoft.org/schema/mule/metadata"
      xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd">
    <flow name="sampleFlow">
        <dw:transform-message>
            <dw:input-payload mimeType="application/json"/>
            <dw:set-payload><![CDATA[%dw 1.0
%dw 1.0
%output application/json
%input payload application/json
%var conversionRate=13.15
---
[1, 2, 3, 4] map ,
]]></dw:set-payload>
            <dw:set-payload><![CDATA[%dw 1.0
%output application/json
%input payload application/xml
---
[1, 2, 3, 4] map $ + 1]]></dw:set-payload>
            <dw:set-payload><![CDATA[%dw 1.0
%output application/json
%input payload application/json
---
payload groupBy $.language
]]></dw:set-payload>
        </dw:transform-message>
    </flow>
</mule>

```
**Output (transform_message_with_unsupported_components.bal):**
```ballerina
public type Context record {|
    anydata payload = ();
|};

function _dwMethod1_(xml payload) returns json {
    //TODO: UNSUPPORTED DATAWEAVE EXPRESSION 'map$+1' OF TYPE 'xml' FOUND. MANUAL CONVERSION REQUIRED.
}

function _dwMethod2_(json payload) returns json {
    //TODO: UNSUPPORTED DATAWEAVE EXPRESSION 'groupBy$.language' FOUND. MANUAL CONVERSION REQUIRED.
}

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_(ctx.payload.toJson());
    _dwOutput_ = _dwMethod1_(ctx.payload.toJson());
    _dwOutput_ = _dwMethod2_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(json payload) returns json {
    float conversionRate = 13.15;
    return [1, 2, 3, 4];
    // DATAWEAVE PARSING FAILED.
    // line 7:13 mismatched input 'map' expecting {<EOF>, NEWLINE}

}

```

## Variable

- ### Basic Set Variable

**Input (basic_set_variable.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <set-variable variableName="name" value="John" doc:name="Variable"/>
        <set-variable variableName="age" value="29" doc:name="Variable"/>
        <set-variable variableName="from" value="USA" doc:name="Variable"/>
        <logger
                message="Variables defined are: name - #[flowVars.name], age - #[flowVars['age']], from - #[flowVars['from']]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_set_variable.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type FlowVars record {|
    string name?;
    string age?;
    string 'from?;
|};

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    FlowVars flowVars = {};
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081);

service /mule3 on config {
    resource function get .(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        ctx.flowVars.name = "John";
        ctx.flowVars.age = "29";
        ctx.flowVars.'from = "USA";
        log:printInfo(string `Variables defined are: name - ${ctx.flowVars.name.toString()}, age - ${ctx.flowVars.age.toString()}, from - ${ctx.flowVars.'from.toString()}`);

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

```

- ### Simple Remove Variable

**Input (simple_remove_variable.xml):**
```xml
<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">
    <flow name="weatherServiceFlow">
        <set-variable variableName="greeting" value="#['hello']" doc:name="Variable"/>
        <set-variable variableName="from" value="#['USA']" doc:name="Variable"/>
        <remove-variable variableName="greeting" doc:name="Variable"/>
        <remove-variable variableName="from" doc:name="Variable"/>
    </flow>
</mule>

```
**Output (simple_remove_variable.bal):**
```ballerina
public type FlowVars record {|
    string greeting?;
    string 'from?;
|};

public type Context record {|
    anydata payload = ();
    FlowVars flowVars = {};
|};

public function weatherServiceFlow(Context ctx) {
    ctx.flowVars.greeting = "hello";
    ctx.flowVars.'from = "USA";
    ctx.flowVars.greeting = ();
    ctx.flowVars.'from = ();
}

```

## Vm Connector

- ### Simple Vm Connector

**Input (simple_vm_connector.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <flow name="outboundVmFlow">
        <set-payload value="#['Hello World']" doc:name="Set Payload"/>
        <vm:outbound-endpoint exchange-pattern="one-way" path="path-xxx" doc:name="VM"/>
    </flow>
    <flow name="inboundVmFlow">
        <vm:inbound-endpoint exchange-pattern="one-way"  doc:name="VM" path="path-xxx"/>
        <logger message="Received a message: #[payload]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (simple_vm_connector.bal):**
```ballerina
import ballerina/log;

public type Context record {|
    anydata payload = ();
|};

public function inboundVmFlow(Context ctx) {
    log:printInfo(string `Received a message: ${ctx.payload.toString()}`);
}

public function outboundVmFlow(Context ctx) {
    worker W returns error? {
        // VM Inbound Endpoint
        anydata receivedPayload = <- function;
        ctx.payload = receivedPayload;
        inboundVmFlow(ctx);
    }

    // set payload
    string payload0 = "Hello World";
    ctx.payload = payload0;

    // VM Outbound Endpoint
    ctx.payload -> W;
}

```

- ### Vm Connector Inside Async Block

**Input (vm_connector_inside_async_block.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="HTTP_Listener_Configuration" host="0.0.0.0" port="8081" basePath="/" doc:name="HTTP Listener Configuration"/>
    <flow name="outboundVmFlow">
        <http:listener config-ref="HTTP_Listener_Configuration" path="/vm" allowedMethods="GET" doc:name="HTTP"/>
        <set-payload value="#['Hello World']" doc:name="Set Payload"/>
        <async doc:name="Async">
            <vm:outbound-endpoint exchange-pattern="one-way" path="path-xxx" doc:name="VM"/>
        </async>
        <logger message="xxx: logger after async block invoked" level="INFO" doc:name="Logger"/>
    </flow>
    <flow name="inboundVmFow">
        <vm:inbound-endpoint exchange-pattern="one-way"  doc:name="VM" path="path-xxx"/>
        <logger message="Received a message: #[payload]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (vm_connector_inside_async_block.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener HTTP_Listener_Configuration = new (8081);

service / on HTTP_Listener_Configuration {
    resource function get vm(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};

        // set payload
        string payload0 = "Hello World";
        ctx.payload = payload0;

        // async operation
        _ = start async0(ctx);
        log:printInfo("xxx: logger after async block invoked");

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

public function vmReceive0(Context ctx) {
    log:printInfo(string `Received a message: ${ctx.payload.toString()}`);
}

public function async0(Context ctx) {
    worker W returns error? {
        // VM Inbound Endpoint
        anydata receivedPayload = <- function;
        ctx.payload = receivedPayload;
        vmReceive0(ctx);
    }

    // VM Outbound Endpoint
    ctx.payload -> W;
}

```

- ### Vm Connector Wth Http Source

**Input (vm_connector_wth_http_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="HTTP_Listener_Configuration" host="0.0.0.0" port="8081" basePath="/" doc:name="HTTP Listener Configuration"/>
    <flow name="outboundVmFlow">
        <http:listener config-ref="HTTP_Listener_Configuration" path="/vm" allowedMethods="GET" doc:name="HTTP"/>
        <set-payload value="#['Hello World']" doc:name="Set Payload"/>
        <vm:outbound-endpoint exchange-pattern="one-way" path="path-xxx" doc:name="VM"/>
    </flow>
    <flow name="inboundVmFow">
        <vm:inbound-endpoint exchange-pattern="one-way"  doc:name="VM" path="path-xxx"/>
        <logger message="Received a message: #[payload]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (vm_connector_wth_http_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Request request;
    http:Response response;
    map<string> uriParams = {};
|};

public type Context record {|
    anydata payload = ();
    InboundProperties inboundProperties;
|};

public listener http:Listener HTTP_Listener_Configuration = new (8081);

service / on HTTP_Listener_Configuration {
    resource function get vm(http:Request request) returns http:Response|error {
        Context ctx = {inboundProperties: {request, response: new}};
        worker W returns error? {
            // VM Inbound Endpoint
            anydata receivedPayload = <- function;
            ctx.payload = receivedPayload;
            vmReceive0(ctx);
        }

        // set payload
        string payload0 = "Hello World";
        ctx.payload = payload0;

        // VM Outbound Endpoint
        ctx.payload -> W;

        ctx.inboundProperties.response.setPayload(ctx.payload);
        return ctx.inboundProperties.response;
    }
}

public function vmReceive0(Context ctx) {
    log:printInfo(string `Received a message: ${ctx.payload.toString()}`);
}

```

